# 운영체제

운영체제란 `하드웨어를 관리하고, 응용 프로그램과 하드웨어 사이에서 인터페이스 역활을 하며 시스템의 동작을 제어하는 시스템 소프트웨어로 정의`한다.

즉 시스템의 자원과 동작을 관리하는 소프트웨어이다.

* [프로세스와 스레드](#프로세스와-스레드)

---
</br>

## 프로세스와 스레드

### 프로세스(Process)

* 실행중인 프로그램으로 디스크로부터 메모리에 적재되어 CPU를 할당 받을 수 있는거
* 운체로부터 주소 공간, 파일, 메모리 등을 할당 받으며 이것들을 프로세스라고 한다.
* 프로세스 스택과 전역 변수를 수록하는 데이터 섹션을 포함한다. 또한 동적으로 할당되는 메모리인 힙을 포함한다.

### PCB(프로세스 제어 블록)

* 특정 프로세스에 대한 중요한 정보를 저장하고 있는 것
* 프로세스의 생성과 동시에 고유한 PCB를 생성한다.
* CPU를 할당받아 작업을 처리하다 프로세스 전환이 발생하면 진행하던 작업을 저장하고 CPU를 반환해야하는데 이때 작업의 진행사항을 PCB에 저장한다.
* 다시 CPU를 할당받으면 PCB에 저장된 내용을 불러온다.

### PCB에 저장되는 정보

* 프로세스 식별자(PID): 프로세스 식별번호
* 프로세스 식별자(Process ID, PID) : 프로세스 식별번호
* 프로세스 상태 : new, ready, running, waiting, terminated 등의 상태를 저장
* 프로그램 카운터 : 프로세스가 다음에 실행할 명령어의 주소
* CPU 레지스터
* CPU 스케쥴링 정보 : 프로세스의 우선순위, 스케줄 큐에 대한 포인터 등
* 메모리 관리 정보 : 페이지 테이블 또는 세그먼트 테이블 등과 같은 정보를 포함
* 입출력 상태 정보 : 프로세스에 할당된 입출력 장치들과 열린 파일 목록
* 어카운팅 정보 : 사용된 CPU 시간, 시간제한, 계정번호 등

### 스레드(Thread)

* 스레드는 프로세스의 실행단위
* 프로세스 내에서 동작되는 여러 실행 흐름, 주소 공간이나 자원을 공유한다.
* 스레드는 스레드 ID, 프로그램 카운터, 레지스터 집합, 그리고 스택으로 구성된다.
* 같은 프로세스에 속한 다른 쓰레드와 코드, 데이터, 열린 파일이나 신호와 같은 운영체제 자원들을 공유한다. 
* 하나의 프로세스를 다수의 실행단위로 구분하여 자원을 공유하고 자원의 생성과 관리의 중복성을 최소화하여 수행 능력을 향상시키는 것을 멀티스레딩이라고한다. 이 경우 각각의 스레드는 독립적인 작업을 수행해야하기 때문에 각자의 스택과 PC 레지스터 값을 갖고 있다.

### 스레드 VS 프로세스

* 프로세스는 자신만의 고유 공간과 자원을 할당받아 사용
* 스레드는 다른 스레드와 공간 자원을 공유하면서 사용

### 멀티 프로세스

* 여려 프로세스를 두고 동시에 처리함
* 장점: 안정성(메모리 침범 문제를 OS차원에서 해결)
* 단점: 각각 독립된 메모리 영역을 갖고있어, 작업량이 많을 수록 오버헤드 발생, Context Switshing으로 인한 성능 저하

### Context Switch?

* 프로세스의 상태 정보를 저장하고 복원하는 과정
* 프로세스는 각 독립된 메모리 영역을 할당받아 사용하므로 캐시 메모리 초기화로 오버헤드가 발생할 문제 존재 -> 줄이려면 콘텍스트 정보를 줄이면됨

### 멀티스레드

* 프로세스를 이용하여 동시에 처리하던 일을 스레드로 구현
* 메모리 공간과 시스템 자원 소모가 감소
* 스레드간 통신이 필요한 경우에도 별도 자원 필요 없음
* 스레드의 context switch는 캐시 메모리를 비울 필요가 없기 때문에 더 빠르다.
* 시스템의 throughput(처리율)이 향상되고 자원 소모가 줄어들며 응답시간이 단축된다.

#### 단점

* 동일한 자원을 여러 스레드가 공유하기 때문에 엉뚱한 값을 불러오거나 저장하는 문제가 있다.
* 그래서 동기와 작업이 필요, 동기화를 통해 작업 처리 순서를 컨트롤, 그러나 병목현상이 발생할 수 있다.
* 안정성 문제, 하나의 스레드가 데이터 공간을 망가뜨리면 모든 스레드가 작동불능
* Critical Section(상호 배제, 진행, 한정된 대기를 충족) 기법으로 해결가능

### 프로세스의 주소 공간

* 코드 Segment: 프로그램 소스 코드 저장
* 데이터 Segment:전역 변수 저장
* 스택 Segment: 함수, 지역 변수 저장
* 나누는 이유: 최대한 데이터를 공유하여 메모리 사용량을 줄임 -> Code는 같은 프로그램 자체에서는 모두 같은 내용, Stack과 data는 스택 구조의 특성과 전역 변수의 활용성 때문

### 인터럽트

* 프로그램을 실행하는 도중에 예기치 않을 상황이 발생할 경우 실행 중인 작업을 중단하고, 상황부터 처리가 필요하다고 CPU에게 알리는것
* 입출력, 우선 순위 연산 같은 일이...
* 외부/내부 인터럽트는 CPU의 하드웨어 신호(외부:전원 이상, 기계 착오, 외부 신호, 입출력 내부: Trap이라고 부르며, 잘못된 명령이나 데이터를 사용할때 발생)에 의해 발생
* 소프트웨어 인터럽트는 명령어의 수행에 의해 발생 (SVC 인터럽트)

#### 인터럽트 발생 처리 과정
